<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MLB Edge Finder ‚Äî Real-Time Betting Intelligence</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --bg: #0a0e17;
            --surface: #131a2b;
            --surface-2: #1c2640;
            --border: #243050;
            --text: #e8ecf4;
            --muted: #7b8ba5;
            --green: #22c55e;
            --red: #ef4444;
            --gold: #f59e0b;
            --blue: #3b82f6;
            --purple: #8b5cf6;
        }
        body { font-family: 'SF Pro Display', -apple-system, sans-serif; background: var(--bg); color: var(--text); }

        /* Top Bar */
        .topbar {
            background: linear-gradient(180deg, var(--surface), var(--bg));
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .topbar h1 {
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .topbar h1 span { color: var(--gold); }
        .live-badge {
            background: var(--red);
            color: white;
            font-size: 0.65rem;
            font-weight: 700;
            padding: 2px 8px;
            border-radius: 10px;
            animation: pulse 2s infinite;
        }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        .topbar-stats {
            display: flex;
            gap: 1.5rem;
            font-size: 0.85rem;
        }
        .topbar-stats .stat { color: var(--muted); }
        .topbar-stats .stat strong { color: var(--text); }

        /* Layout */
        .content { padding: 1.5rem 2rem; max-width: 1400px; margin: 0 auto; }

        /* Summary Cards */
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .summary-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            text-align: center;
        }
        .summary-card .value {
            font-size: 2rem;
            font-weight: 800;
            margin: 0.25rem 0;
        }
        .summary-card .label { font-size: 0.75rem; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; }
        .summary-card .value.green { color: var(--green); }
        .summary-card .value.gold { color: var(--gold); }
        .summary-card .value.blue { color: var(--blue); }
        .summary-card .value.purple { color: var(--purple); }

        /* Filter Bar */
        .filter-bar {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        .filter-btn {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 8px;
            color: var(--muted);
            padding: 8px 16px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.15s;
        }
        .filter-btn:hover, .filter-btn.active {
            background: var(--blue);
            color: white;
            border-color: var(--blue);
        }

        /* Game Cards */
        .games-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        .game-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 14px;
            overflow: hidden;
            transition: border-color 0.15s;
        }
        .game-card:hover { border-color: var(--blue); }
        .game-card.has-edge { border-left: 4px solid var(--green); }
        .game-card.strong-edge { border-left: 4px solid var(--gold); }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.25rem;
            border-bottom: 1px solid var(--border);
        }
        .game-time { color: var(--muted); font-size: 0.8rem; }
        .game-grades {
            display: flex;
            gap: 0.5rem;
        }
        .grade {
            padding: 2px 10px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 700;
        }
        .grade.a { background: #065f4630; color: var(--green); }
        .grade.b { background: #1c477030; color: var(--blue); }
        .grade.c { background: #3b290030; color: var(--gold); }
        .grade.d { background: #3b100030; color: var(--red); }

        .game-body {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 0;
            padding: 1.25rem;
        }
        .team-col {
            text-align: center;
        }
        .team-name {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }
        .team-record { font-size: 0.8rem; color: var(--muted); }
        .team-prob {
            font-size: 2rem;
            font-weight: 800;
            margin: 0.5rem 0;
        }
        .team-prob.favored { color: var(--green); }
        .team-prob.underdog { color: var(--muted); }
        .team-ml {
            font-size: 0.85rem;
            color: var(--muted);
        }

        .vs-col {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 0 2rem;
        }
        .vs-divider {
            width: 2px;
            height: 40px;
            background: var(--border);
            margin: 0.5rem 0;
        }
        .vs-text { color: var(--muted); font-size: 0.75rem; }

        .game-factors {
            display: flex;
            gap: 0.5rem;
            padding: 0 1.25rem 1rem;
            flex-wrap: wrap;
        }
        .factor {
            background: var(--surface-2);
            border-radius: 6px;
            padding: 4px 10px;
            font-size: 0.75rem;
            color: var(--muted);
        }
        .factor.positive { color: var(--green); background: #065f4620; }
        .factor.negative { color: var(--red); background: #3b100020; }
        .factor.neutral { color: var(--gold); }

        .game-edge {
            background: var(--surface-2);
            padding: 0.75rem 1.25rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid var(--border);
        }
        .edge-value {
            font-weight: 700;
            font-size: 1.1rem;
        }
        .edge-value.positive { color: var(--green); }
        .edge-value.negative { color: var(--red); }
        .bet-rec {
            background: var(--green);
            color: #0a0e17;
            padding: 4px 14px;
            border-radius: 8px;
            font-weight: 700;
            font-size: 0.85rem;
        }
        .bet-rec.pass { background: var(--surface); color: var(--muted); border: 1px solid var(--border); }

        /* Risk Flags */
        .risk-flags {
            padding: 0.5rem 1.25rem 0.75rem;
        }
        .risk-flag {
            font-size: 0.8rem;
            color: var(--gold);
            margin: 2px 0;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 2rem;
            color: var(--muted);
            font-size: 0.75rem;
        }

        @media (max-width: 768px) {
            .summary-grid { grid-template-columns: repeat(2, 1fr); }
            .game-body { grid-template-columns: 1fr; text-align: center; }
            .vs-col { flex-direction: row; padding: 0.5rem 0; }
            .vs-divider { width: 40px; height: 2px; }
            .topbar { flex-direction: column; gap: 0.5rem; }
            .content { padding: 1rem; }
        }
    </style>
</head>
<body>
    <div class="topbar">
        <h1>‚öæ MLB <span>Edge Finder</span> <span class="live-badge">LIVE</span></h1>
        <div class="topbar-stats">
            <div class="stat">Record: <strong id="seasonRecord">--</strong></div>
            <div class="stat">ROI: <strong id="seasonROI">--</strong></div>
            <div class="stat">Updated: <strong id="lastUpdate">--</strong></div>
        </div>
    </div>

    <div class="content">
        <div class="summary-grid" id="summaryCards">
            <div class="summary-card">
                <div class="label">Today's Games</div>
                <div class="value blue" id="totalGames">0</div>
            </div>
            <div class="summary-card">
                <div class="label">Edges Found</div>
                <div class="value green" id="edgesFound">0</div>
            </div>
            <div class="summary-card">
                <div class="label">Strong Edges</div>
                <div class="value gold" id="strongEdges">0</div>
            </div>
            <div class="summary-card">
                <div class="label">Avg Confidence</div>
                <div class="value purple" id="avgConfidence">--</div>
            </div>
            <div class="summary-card">
                <div class="label">Model Agreement</div>
                <div class="value" id="avgAgreement">--</div>
            </div>
        </div>

        <div class="filter-bar">
            <button class="filter-btn active" onclick="filterGames('all')">All Games</button>
            <button class="filter-btn" onclick="filterGames('edge')">üéØ Has Edge</button>
            <button class="filter-btn" onclick="filterGames('strong')">üî• Strong Edge</button>
            <button class="filter-btn" onclick="filterGames('high-conf')">üíé High Confidence</button>
            <button class="filter-btn" onclick="filterGames('over')">üìà Over Value</button>
        </div>

        <div class="games-grid" id="gamesGrid"></div>
    </div>

    <div class="footer">
        <p>MLB Edge Finder ‚Äî Powered by 11-model ensemble predictor</p>
        <p>Models: ELO ¬∑ Pitcher ¬∑ Bullpen ¬∑ Weather ¬∑ Umpire ¬∑ Stadium ¬∑ Lineup ¬∑ Momentum ¬∑ H2H ¬∑ Splits ¬∑ Rest</p>
        <p>‚ö†Ô∏è For entertainment purposes only. Gamble responsibly.</p>
    </div>

    <script>
        let allGames = [];

        function loadGames() {
            // Demo data ‚Äî in production, fetch from /api/ensemble/today
            allGames = generateDemoGames();
            updateSummary();
            renderGames(allGames);
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
        }

        function updateSummary() {
            document.getElementById('totalGames').textContent = allGames.length;
            const edges = allGames.filter(g => Math.abs(g.edge) > 0.03);
            document.getElementById('edgesFound').textContent = edges.length;
            document.getElementById('strongEdges').textContent = allGames.filter(g => Math.abs(g.edge) > 0.06).length;

            const avgConf = allGames.reduce((s, g) => s + g.confidence, 0) / allGames.length;
            document.getElementById('avgConfidence').textContent = (avgConf * 100).toFixed(0) + '%';

            const avgAgree = allGames.reduce((s, g) => s + g.agreement, 0) / allGames.length;
            document.getElementById('avgAgreement').textContent = (avgAgree * 100).toFixed(0) + '%';

            document.getElementById('seasonRecord').textContent = '142-118';
            document.getElementById('seasonROI').textContent = '+8.4%';
        }

        function renderGames(games) {
            const grid = document.getElementById('gamesGrid');
            grid.innerHTML = games.map(g => {
                const edgeClass = Math.abs(g.edge) > 0.06 ? 'strong-edge' : Math.abs(g.edge) > 0.03 ? 'has-edge' : '';
                const predGrade = gradeClass(g.predGrade);
                const valueGrade = gradeClass(g.valueGrade);
                const homeFavored = g.homeProb > 0.5;

                return `
                <div class="game-card ${edgeClass}" data-edge="${Math.abs(g.edge)}" data-conf="${g.confidence}" data-over="${g.overProb}">
                    <div class="game-header">
                        <span class="game-time">${g.time} ¬∑ ${g.venue}</span>
                        <div class="game-grades">
                            <span class="grade ${predGrade}">Pred: ${g.predGrade}</span>
                            <span class="grade ${valueGrade}">Value: ${g.valueGrade}</span>
                        </div>
                    </div>
                    <div class="game-body">
                        <div class="team-col">
                            <div class="team-name">${g.away}</div>
                            <div class="team-record">${g.awayRecord}</div>
                            <div class="team-prob ${!homeFavored ? 'favored' : 'underdog'}">${(g.awayProb * 100).toFixed(1)}%</div>
                            <div class="team-ml">${g.awayML > 0 ? '+' : ''}${g.awayML}</div>
                        </div>
                        <div class="vs-col">
                            <div class="vs-text">O/U</div>
                            <div style="font-weight:700">${g.ouLine}</div>
                            <div class="vs-divider"></div>
                            <div class="vs-text">Total</div>
                            <div style="font-weight:700; color:${g.projTotal > g.ouLine ? 'var(--green)' : 'var(--red)'}">${g.projTotal}</div>
                        </div>
                        <div class="team-col">
                            <div class="team-name">${g.home}</div>
                            <div class="team-record">${g.homeRecord}</div>
                            <div class="team-prob ${homeFavored ? 'favored' : 'underdog'}">${(g.homeProb * 100).toFixed(1)}%</div>
                            <div class="team-ml">${g.homeML > 0 ? '+' : ''}${g.homeML}</div>
                        </div>
                    </div>
                    <div class="game-factors">
                        ${g.factors.map(f => `<span class="factor ${f.type}">${f.text}</span>`).join('')}
                    </div>
                    ${g.risks.length ? `<div class="risk-flags">${g.risks.map(r => `<div class="risk-flag">${r}</div>`).join('')}</div>` : ''}
                    <div class="game-edge">
                        <div>
                            <span style="color:var(--muted);font-size:0.8rem">Edge: </span>
                            <span class="edge-value ${g.edge > 0 ? 'positive' : g.edge < -0.03 ? 'negative' : ''}">${(g.edge * 100).toFixed(1)}%</span>
                            <span style="color:var(--muted);font-size:0.8rem"> ¬∑ Kelly: ${(g.kelly * 100).toFixed(1)}%</span>
                        </div>
                        <span class="bet-rec ${g.rec === 'pass' ? 'pass' : ''}">${g.rec === 'pass' ? 'PASS' : 'üéØ BET ' + g.rec.toUpperCase()}</span>
                    </div>
                </div>`;
            }).join('');
        }

        function gradeClass(grade) {
            if (grade.startsWith('A')) return 'a';
            if (grade.startsWith('B')) return 'b';
            if (grade.startsWith('C')) return 'c';
            return 'd';
        }

        function filterGames(type) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');

            let filtered = allGames;
            if (type === 'edge') filtered = allGames.filter(g => Math.abs(g.edge) > 0.03);
            if (type === 'strong') filtered = allGames.filter(g => Math.abs(g.edge) > 0.06);
            if (type === 'high-conf') filtered = allGames.filter(g => g.confidence > 0.65);
            if (type === 'over') filtered = allGames.filter(g => g.overProb > 0.55);
            renderGames(filtered);
        }

        function generateDemoGames() {
            const matchups = [
                { away: 'NYY', home: 'BOS', awayR: '52-30', homeR: '48-34', venue: 'Fenway Park', time: '7:10 PM' },
                { away: 'LAD', home: 'SF', awayR: '55-27', homeR: '44-38', venue: 'Oracle Park', time: '9:45 PM' },
                { away: 'HOU', home: 'TEX', awayR: '50-32', homeR: '46-36', venue: 'Globe Life Field', time: '8:05 PM' },
                { away: 'ATL', home: 'NYM', awayR: '49-33', homeR: '42-40', venue: 'Citi Field', time: '7:10 PM' },
                { away: 'SD', home: 'ARI', awayR: '46-36', homeR: '47-35', venue: 'Chase Field', time: '9:40 PM' },
                { away: 'PHI', home: 'MIA', awayR: '51-31', homeR: '35-47', venue: 'loanDepot Park', time: '6:40 PM' },
                { away: 'MIN', home: 'CLE', awayR: '47-35', homeR: '48-34', venue: 'Progressive Field', time: '6:40 PM' },
                { away: 'SEA', home: 'OAK', awayR: '44-38', homeR: '28-54', venue: 'Oakland Coliseum', time: '9:40 PM' },
            ];

            return matchups.map(m => {
                const homeProb = 0.35 + Math.random() * 0.3;
                const awayProb = 1 - homeProb;
                const mktHome = homeProb + (Math.random() - 0.5) * 0.08;
                const edge = homeProb - mktHome;
                const conf = 0.45 + Math.random() * 0.35;
                const agree = 0.4 + Math.random() * 0.45;
                const kelly = Math.max(0, edge * 0.25);
                const projTotal = 7 + Math.random() * 4;
                const ouLine = Math.round(projTotal * 2) / 2 + (Math.random() > 0.5 ? 0.5 : -0.5);
                const overProb = 0.5 + (projTotal - ouLine) * 0.1;

                const homeML = homeProb > 0.5 ? Math.round(-100 * homeProb / (1 - homeProb)) : Math.round(100 * (1 - homeProb) / homeProb);
                const awayML = awayProb > 0.5 ? Math.round(-100 * awayProb / (1 - awayProb)) : Math.round(100 * (1 - awayProb) / awayProb);

                const rec = Math.abs(edge) > 0.03 && conf > 0.55 ? (edge > 0 ? m.home : m.away) : 'pass';

                const predScore = conf * 60 + agree * 40;
                const predGrade = predScore >= 80 ? 'A' : predScore >= 65 ? 'B+' : predScore >= 50 ? 'B' : 'C';
                const valueScore = Math.abs(edge) * 200 + conf * 30;
                const valueGrade = valueScore >= 35 ? 'A' : valueScore >= 22 ? 'B' : valueScore >= 10 ? 'C' : 'D';

                const factors = [
                    { text: `üå°Ô∏è ${Math.round(65 + Math.random() * 30)}¬∞F`, type: 'neutral' },
                    { text: homeProb > 0.55 ? 'üè† Home advantage' : '‚úàÔ∏è Road team edge', type: homeProb > 0.55 ? 'positive' : 'negative' },
                    { text: `üí™ Fatigue: ${Math.round(20 + Math.random() * 40)}/100`, type: Math.random() > 0.5 ? 'neutral' : 'negative' },
                ];
                if (Math.random() > 0.5) factors.push({ text: 'üî• Hot streak', type: 'positive' });
                if (Math.random() > 0.7) factors.push({ text: 'üí® Wind 15+ mph', type: 'negative' });

                const risks = [];
                if (agree < 0.5) risks.push('‚ö†Ô∏è Models disagree ‚Äî high uncertainty');
                if (Math.random() > 0.7) risks.push('üåßÔ∏è Rain possible ‚Äî monitor weather');

                return {
                    ...m, homeProb, awayProb, homeML, awayML, edge, confidence: conf,
                    agreement: agree, kelly, rec, projTotal: Math.round(projTotal * 10) / 10,
                    ouLine, overProb, predGrade, valueGrade, factors, risks,
                    awayRecord: m.awayR, homeRecord: m.homeR,
                };
            }).sort((a, b) => Math.abs(b.edge) - Math.abs(a.edge));
        }

        // Load on page init
        loadGames();
        // Auto-refresh every 60 seconds
        setInterval(loadGames, 60000);
    </script>
</body>
</html>
